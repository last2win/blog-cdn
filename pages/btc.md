---
layout: post
title: "炒币与量化交易"
categories: [区块链,投资]
description: ""
comments: true
permalink: /btc/
---

此文首发于我的Jekyll博客：[zhang0peter的个人博客](https://zhang0peter.com)         

本文主要记载我的炒币经历和感悟

## 炒币经历与量化交易完善过程


2020-3-15：以5338美元价格买入一万元比特币
{% raw %}
***          
{% endraw %}

2020-3-20：以6000美元卖出0.245个比特币，获得1万9百，详细过程见：[第一次进行比特币交易的尝试 — zhang0peter的博客](https://zhang0peter.com/2020/03/20/buy-btc/)

当时的想法是等到币价重新回到5300美元左右再重新买入，做长线。
{% raw %}
***          
{% endraw %}

2020-4-2：尝试短线交易/量化交易

看到币价在不停波动，于是打算做短线交易
{% raw %}
***          
{% endraw %}
2020-4-3：写了一篇文章：[关于区块链的一些思考：稳定币USDT的价值和虚拟货币涨跌趋势](https://zhang0peter.com/2020/04/03/blockchain/)  
       

{% raw %}
***          
{% endraw %}
2020-4-9：短线交易初始策略版本完成。

早上看行情，发现大幅度下跌基本在15分钟就全部跌完了。设置价格平均值为过去一小时的平均价格，如果当前价格相比平均价格下跌超过0.6%，那么等待2分钟不再下跌即可买入。买入后，涨幅达到0.5%后，等待2分钟不再涨即可卖出。

在`2020-4-9 19:30` 左右，比特币实盘策略交易成功，总金额 1000 USDT，赚 10 USDT
{% raw %}
***          
{% endraw %}
2020-4-10：
中午比特币从 7300$ 跌到 7150$ 时，我买入1000 USDT；随后从 7150$ 跌到 7000$ 。

直接把昨晚的盈利亏光了。

感觉要设置强平的策略，不然如果我在比特币的最高点过后刚下跌的时候买入，那就会亏的裤衩都没了。

我设置在当前价格比买入价格低1%时，强行平仓。

幸运的是今天在okex的群友那里拿到了2016年起的每分钟比特币价格数据，包括2017年的最高点1万多美元。

测试当前设置的数据时，可以赚钱。

我测试后感觉不对劲，因为2016年到2017年底中有大牛市，大牛市中任何策略都可以赚到钱，我要把这段时间去掉，找一个保守些的策略。

设置好策略后，账户初始资金1100USDT，每次交易1000USDT。

{% raw %}
***          
{% endraw %}
2020-4-13: 量化交易第一次实战操作

早上比特币价格忽然大幅度波动，从 7000美元一路跌到了6800美元。

自动交易系统在6625美元时买进1000USDT的比特币，然后在6689美元时准备卖出，如果按计划卖出，可以赚0.9%，这就是一次完美的量化交易操作。

但等到我按市价买入时，比特币的价格已经升到了6640美元，而按市价卖出时，价格又降到了6673美元，也就是说本来0.9%的利润变成了0.4%的利润(还要交0.3%的手续费)。

查看代码，发现了确实存在购买前的耗时操作。我是先发邮件提醒，再购买，时间过去10秒，价格发生了波动，应该先购买，再发邮件。

最终实际花费1001 USDT，到手1003 USDT，赚了2USDT/0.2%

{% raw %}
***          
{% endraw %}
2020-4-15：

自己看比特币行情，感觉要涨了，于是买了1500 USDT的比特币。但随后的持币过程中，看价格的波动，又感觉不对，于是分2次卖了。净亏损7 USDT。

以后还是让系统炒币，机器是没有感情的，知道什么时候应该买，涨了多少就该卖了。

{% raw %}
***          
{% endraw %}

2020-4-16：尝试使用机器学习训练模型，失败。因为我需要的不是根据过去29分钟的价格数据，预测未来1分钟的价格数据的人工智能，而是精通行情，看交易数据能看出未来走势的交易员。
{% raw %}
***          
{% endraw %}
2020-4-21：
因为持有OKB可以降低手续费，所以最近几天在炒OKB。在杠杆交易中进行买卖。

过去的几天中累计赚了400 USDT，但今天的操作直接亏损了 40 USDT。

我也看不懂OKB的走势，只知道OKB的走势跟比特币类似，以后不炒OKB了。

{% raw %}
***          
{% endraw %}

2020-4-22：

写了一篇文章：
[关于区块链的思考(续)：不同交易所相同价格波动成因与交易所的暴利](https://zhang0peter.com/2020/04/22/blockchain/)     

认购了OKB，OK交易所从市场回购200万USDT等值的OKB，用户只需要付80%的价格就可以认购OKB。

早上10:20开始回购，OKB的价格从4.41在15分钟左右拉升到了4.6。官方通告OKB的24小时平均价格为4.4 USDT，回购价格为3.5 USDT。每个用户可以回购1000 USDT的OKB，其中认购系数由历史交易量决定，有3挡：1, 1.2, 1.5

因为我的交易量小于50BTC，所以我的认购系数为1

我认购了 1000 USDT的OKB，最终支付158 USDT，认购45 OKB。

这意味着假设每个有资格认购的用户都认购了1000 USDT，总共有1万2千的1挡用户。

假设OK交易所的主体用户是1.5档的，那么有8千1.5档的活跃炒币散户。

我随后把45个OKB以4.573的价格卖了，到手205 USDT，赚了47 USDT。
{% raw %}
***          
{% endraw %}
2020-4-23：
开始尝试合约交易，并把量化交易的程序由低价买币高价买币，改为永续合约低价做多，高价平仓。
{% raw %}
***          
{% endraw %}
2020-4-24：

在杠杆交易中，向交易所借 500OKB，用来降低手续费，日利率0.1%，每天利率0.5 OKB。

因为杠杆交易需要保证金，因此有1026 USDT保证金抵押在账户中，无法进行交易。
{% raw %}
***          
{% endraw %}
2020-4-28：尝试期权交易

今天尝试了期权交易，5.1到期，到时候看能不能赚钱。

主要是想到买期权不赚钱，那么我坐庄，卖期权应该可以赚钱。
{% raw %}
***          
{% endraw %}
2020-4-29：写了一篇文章：[给币圈新手的介绍：币币交易，杠杆交易，永续合约，交割合约，期权 — zhang0peter的博客](https://zhang0peter.com/2020/04/29/Digital-currency-trade-intro/)

没想到比特币从早上的7800一路涨到了8700，期权交易坐庄亏钱了。。。
{% raw %}
***          
{% endraw %}

2020-4-30：
今天的行情特别奇怪，感觉有大庄家在控盘。早上从8700一路涨到9500，下午2点之后震荡下跌到8500。庄家打爆空头后打多头。根据合约帝的统计，24小时内爆仓了6.7亿美元，大约47亿人民币的仓位。


{% raw %}
***          
{% endraw %}

2020-5-1：

火币的微信群是任何人都可以加，所以有各种各样的人，okex的群成员经过了筛选，没有闲杂人等。但火币的群更活跃，因为人多。火币群里的人群魔乱舞，不仅有推销信用卡套现的人，也有传销的人，还有骗子和推荐山寨币的，包括pi币和瑞波币，今天发现居然还有提供房产抵押服务的人。

今天是周五，下午期权交易结算完成。我总共往期权账户里转了0.6 BTC，结算后只剩0.568 BTC，亏损0.035 BTC，大约300美元。

感觉我还是做期货的买家比较好，用期货来对冲风险。

{% raw %}
***          
{% endraw %}
2020-5-2：

修改量化交易程序，之前是跌幅超过最小阈值，等待买入；如果跌幅超过最大阈值，直接买入。现在修改程序为跌幅超过最大阈值，不买，因为比特币很可能在这段时间会剧烈波动。

最早的时候调试量化交易程序的时候都是以利润最大化为目的，现在调试程序时，允许利润的减少，但要求参数尽可能符合人的要求，也就是看起来更合理。

今天突发奇想，假设我在合约中同时进行开多和开空，同配上较高的杠杆，比如说100倍杠杆。这样假设比特币价格上涨，做空的就爆仓了，做多的想要赚回本金，需要比特币上涨1%即可把亏的本金赚回来，上涨1.5%就算赚大了。但问题是有时候不一定会单方面涨。如果币价在震荡中把所有仓位都爆了，那么这种做法毫无意义。

{% raw %}
***          
{% endraw %}
2020-5-3：
今天本来要买的，结果报错说单次市价下单不能超过400张。我咨询客服后发现，BTC-USDT单次市价下单只能400张，而BTC-USD的币本位单次市价下单运行1000张。于是我把程序分成了2个部分，一部分购买400张BTC-USDT的合约，另一部分购买400张BTC-USD合约。

{% raw %}
***          
{% endraw %}
2020-5-4：

比特币将于5月12号减半，有许多人在吹比特币将迎来牛市。我觉得比特币到时候肯定会有剧烈波动，那么我可以提前锁定波动。前天已经买了5月8号的期权，但如果等到5月8号再买5月15号的期权，太晚了。于是今天就买了5月15号到期的期权。具体购买操作见下方的期权交易操作。

{% raw %}
***          
{% endraw %}
2020-5-5：

统计了从买入到卖出的平均时间，如下图：

![图片]({% link /images/2020/2020-5-4.png %})

可以看出大部分交易的完成时间在4000秒以内，也就是一小时内完成交易。

经旧数据和现有的新数据测试，我选择4000秒后没有交易就强行平仓。

{% raw %}
***          
{% endraw %}

2020-5-6：

昨晚发生了一次购买后超时强平，这是因为比特币价格在一次暴跌后等待了几分钟进行第二次暴跌，因此就算调大最小跌幅购买率也毫无作用。这是一次无法避免的持有超时产生的强行平仓。

{% raw %}
***          
{% endraw %}

2020-5-7：

昨晚发生了一起交易，有2个有趣的点。

一个是预计购买价格与实际购买价格差了25，这是因为我获取的价格是最新成交价格，而成交价格的变动是非常大的，更推荐的做法是使用指数价格或者标记价格。

另一个则是BTCUSD永续产生了交易，但BTCUSDT永续并没有交易。这是因为2个程序的开始时间有所差别，导致一个成交，另一个没有成交。

我把程序的价格从最新成交价格换成了标记价格，重新运行。


{% raw %}
***          
{% endraw %}

2020-5-7：

一个名叫NDN的虚拟货币项目借助okex平台进行私募。其实没有多少人真的关心这个币的前景到底怎样，我也不关心，大家只关心买这个币能不能赚钱。

我统计了之前在Okex平台进行过私募的币，结果如下：


| 币名  |  认购时间  | 认购价格 | 私募发行价格 |   现价   | 历史最高价 |
| :---: | :--------: | :------: | :----------: | :------: | :--------: |
|  NDN  | 2020/05/20 |  0.006   |     0.02     | 尚未发行 |  尚未发行  |
|  DEP  | 2020/04/08 |  0.0025  |    0.005     | 0.004774 |   0.0065   |
| HDAO  | 2020/02/25 |   0.01   |     0.02     |  0.026   |   0.051    |
| ROAD  | 2019/11/14 | 0.01428  |    0.0285    | 0.02291  |  0.07323   |
|  XPO  | 2019/09/11 |  0.005   |     0.01     | 0.00024  |  0.03999   |
|  PLG  | 2019/08/22 |  0.0025  |    0.0067    | 0.00031  |  0.01449   |

可以看出所有的币的历史最高价都高于私募发行价格，自然也高于认购价格，可以认为是一件稳赚不赔的生意。

认购于2020年5月20号开始，规则是使用OKB进行认购，因此我要找个合适的时机买入OKB。

这个币的认购价格为0.006美元，每个用户最多认购670,000 NDN，也就是4000美元的币，考虑到有2轮预购，因此如果要全额预购，需要准备8000美元的OKB。但实际上每轮的销售总量为166,666,667 NDN，换而言之，250个全额认购的用户就把认购额挤爆了。因此准备最多4000美元的OKB就够了。于是我把期权账户和永续账户中多余的BTC都换成了OKB。

{% raw %}
***          
{% endraw %}

2020-5-8:

之前写了一篇文章分析虚拟货币涨跌趋势一致的原因：[关于区块链的一些思考：稳定币USDT的价值和虚拟货币涨跌趋势](https://zhang0peter.com/2020/04/03/blockchain/)  

结果打脸了，在5月6号的行情中，比特币领涨，从8900涨到9300.而LTC，ETH基本没有多少波动。这波行情是比特币领涨，内部的原因不是很清楚。

{% raw %}
***          
{% endraw %}
2020-5-8：

昨晚行情大爆发，比特币创新高，一路从9400涨到了10000，已经完全从疫情的股灾中恢复过来，要知道2月10号的价格也只有1万，在更久远的2019年8月份才涨到过1万1千。群里已经有很多人准备长期低杠杆做空，因为从历史数据来看，比特币处于1万以上的价格时间并不会持久。昨晚涨了6千，但只爆仓了2.6亿美元，因为涨的很慢，而大玩家一般都设有止损，不会轻易爆仓。

昨晚okex的群里终于活跃一回了，不仅是因为比特币价格上涨带来的牛市，而且有很多群友分享了他们的炒币亏损经验。

> 烛照(群友)：              
我二月份进圈，买了8500的现货，炒波段，以为稳一些，一顿操作猛如虎，再加上312，然后赔的还剩一半了            
贪婪啊，一个朋友觉得炒波段能挣更多，所以就参与了，一发不可收拾，直到有一天突然发现币少了一半不能再炒了，炒波段也不是随便就能挣得，最终决定还是老老实实等着吧，            
312把钱套住了，跌到3870后反弹到五千左右，后又跌到4400，以为还会跌，就4550全卖了，然后就傻眼了，没想到是二次探底，直接就涨上去了，等缓过劲来就亏不少了，还有那次6790拉倒7750那次，7150进的，6880出的，拉倒7750后7550又重新进的，这俩波是我记得最清楚的，其他的就没那么清楚了            
别提312了，唉，刚进圈就遇到这么大的阵仗，跌的懵逼了            
买完币后我媳妇还让我把平台退出登录，说什么时候大饼上热搜了，什么时候再登录平台，现在想想，还是她有先见之明啊            
我用的是闲置的钱，不影响生活，不过赔的还是难受            
赔20w，我媳妇知道我赔了，她还以为五万，没敢告诉实话，不过我可不敢去赌一样的炒            


>另一位群友：         
在一个主流币柚子币上赔了很多钱，在价格5美元的时候买了2000个，现在只有2.7了，玩合约又亏了600个EOS。           
3 12 一天  我一个发小  重庆观音桥房子两套   贷款130W 全没了  根本不用梭哈直接给你爆了            
-100的时候你扛着  +50的时候你就想跑了 根本不敢去赌  几十倍 的收益 只有亏得时候  不服输            





{% raw %}
***          
{% endraw %}

2020-5-9:

因为获得的比特币历史价格数据是以分钟为间隔的，所以我的实盘操作也是以分钟为间隔。但有时候会想到如果以半分钟为间隔获取价格进行操作，会不会赚的更多。

初步尝试后放弃了，一个是因为历史数据没有以半分钟为间隔，无法进行模拟。另一个原因是降价的时候还是多等一会儿比较好，心急赚不到钱。

{% raw %}
***          
{% endraw %}

2020-5-10：

在okex的API群里有挺多专门做量化交易的，有一个人提到他在做网格交易，年收益才10%，觉得太低了。另一个专业人士表示他月收益有10%，并建议新手去参加量化交易大赛，表现好就会有人主动联系他，给他投钱。

## 量化交易操作

### BTC-USDT 永续合约交易

2020-04-30 01:53 以8748买入150张永续做多合约(10倍杠杆) 手续费 5.9 USDT        
2020-04-30 04:38 以8816.6卖出合约，                    手续费 5.95 USDT        

赚 90 USDT                
总盈亏：104 USDT                

********************************************************************************************
2020-04-30 12:13 以9070买入250张永续做多合约(16倍杠杆)，实际成交155张  手续费 6  USDT        
2020-04-30 12:19 以9142.4卖出155张合约，                               手续费  6 USDT        

赚 100 USDT        
总盈亏：204 USDT        

********************************************************************************************
2020-04-30 15:21 以9119买入250张永续做多合约(16倍杠杆)， 手续费  10  USDT        
2020-04-30 15:26 以9151卖出合约，                       手续费  10  USDT        

赚 60 USDT        
总盈亏：264 USDT        

********************************************************************************************
2020-04-30 17:07 以8949买入250张永续做多合约(16倍杠杆)，            手续费 10  USDT        
2020-04-30 17:17 手动以8915卖出合约，                              手续费  10  USDT        

亏 95  USDT        
总盈亏：170 USDT        

注：4月30号这天波动太诡异了，先暴涨，再波动下跌。我怕还会下跌，因此手动卖出。如果当时没卖，一直到5月1号，最高价一直为8800美元，亏损400美元。       

********************************************************************************************
2020-05-01 01:38 以8499买入250张永续做多合约(16倍杠杆)，            手续费 10  USDT        
2020-05-01 01:59 以8560卖出合约，                                   手续费 10 USDT        

赚 140 USDT        
总盈亏：380 USDT               

********************************************************************************************
2020-05-03 20:31 以8872(从8871.6到8872.8)买入400张永续做多合约(15倍杠杆)，            手续费 15  USDT        
2020-05-03 20:36 以8922.8(从8923.1到8921.6)卖出合约，                                 手续费 16  USDT        

赚 170 USDT        

总盈亏：550 USDT 
       
********************************************************************************************

2020-05-04 09:25 以8679.2(从8675.5到8683)买入400张永续做多合约(15倍杠杆)，            手续费 16  USDT        
2020-05-04 10:07 以8730卖出合约，                                                     手续费 16  USDT        

赚 170 USDT        

总盈亏：720 USDT        
       
********************************************************************************************

2020-05-05 18:02 以8897.6买入400张永续做多合约(15倍杠杆)，            手续费 16  USDT        
2020-05-05 19:10 超时强行平仓：以8881.5卖出合约，                     手续费 16  USDT        

亏 50  USDT        

总盈亏：670 USDT        

********************************************************************************************

2020-05-07 07:57 计划买入价格为：9121.2，实际以9122.5买入400张永续做多合约(15倍杠杆)，实际降价幅度为：0.0138，手续费 17  USDT        
2020-05-07 08:16 预计卖出价格为：9166.3，实际卖出价格： 9165.3                                手续费 17  USDT        

赚 130 USDT        

总盈亏：800 USDT        

********************************************************************************************

2020-05-07 23:33 以9434.6(从9430.7到9440.8)买入400张永续做多合约(15倍杠杆)，            手续费 17  USDT        
2020-05-07 23:46 以9490.6卖出合约，                                手续费 17  USDT        

赚 190 USDT        

总盈亏：1090 USDT        

********************************************************************************************


### BTC-USD 永续合约交易

2020-05-03 20:32 以8887(从8885.5到8888)买入400张永续做多合约(16倍杠杆)，            手续费 0.002 BTC       
2020-05-03 20:40 以8932.1卖出合约，                                                 手续费 0.002 BTC     

赚 0.018 BTC        

总盈亏： 0.018 BTC 
       
********************************************************************************************

2020-05-04 09:19 以8719.2买入400张永续做多合约(16倍杠杆)，            手续费 0.002 BTC         
正好早上在看行情，等了一小时价格不涨，手动挂单以8740卖出合约，        手续费 0.0008 BTC         

结果在我卖了后价格就上涨到了阈值，于是我打算统计平均的持有时间

赚 0.008  BTC       

总盈亏：0.026 BTC      

********************************************************************************************

2020-05-05 18:01 以8903.9买入400张永续做多合约(15倍杠杆)，            手续费 0.002 BTC         
2020-05-05 19:09 超时强行平仓：以8881.8卖出合约，                         手续费 0.002 BTC         

亏 0.0134  BTC       

总盈亏：0.0126 BTC       

********************************************************************************************

2020-05-06 21:24 以9170.9买入409张永续做多合约(15倍杠杆)，            手续费 0.002 BTC         
             手动以9208.5卖出合约，                                   手续费 0.002 BTC         

赚 0.0138 BTC       

总盈亏：0.0266 BTC       

这次手动卖出的原因是计划于9145买入，实际买入价格为9170，差了25！！

********************************************************************************************

2020-05-07 07:52 以9204.8买入400张永续做多合约(15倍杠杆)，            手续费 0.002 BTC         
2020-05-07 08:58 超时强行平仓，以9197.7卖出合约，                     手续费 0.002 BTC         

亏 0.008  BTC       

总盈亏：0.0186 BTC       

********************************************************************************************


## 期权交易操作

本来想在期权交易中坐庄，然后亏了300美元，于是开始用期权做风险对冲。

2020-5-1：购买5月8号到期的期货，看涨：10500，价格0.007，5张；看跌：7250，价格0.006，5张。总花费 0.065 BTC。

2020-5-4：购买5月15号到期的期货，看涨：11000，价格0.011，杠杆倍数115，10张；看跌：7000，价格0.01，杠杆倍数128，5张。总花费 0.16 BTC。

## 各账户资金持有


2020-5-1：OKB/USDT杠杆账户：1,026 USDT，529 OKB(借了500 OKB)；永续合约：5921 USDT；期权合约：0.2660		 BTC；总估值9475 USDT            

2020-5-6：OKB/USDT杠杆账户：712.9854 OKB(借了500 OKB)；永续合约：0.3829	BTC  2,785.88 USDT；期权合约：0.2543			 BTC；总估值 9,692.37 USDT        


2020-5-7：OKB/USDT杠杆账户：712.9854 OKB(借了500 OKB)；永续合约：0.3891	BTC  2,907.64 USDT；期权合约：0.2442				 BTC；比特币单价9200 USDT，总估值 9,956.88 USDT        

2020-5-7：OKB/USDT杠杆账户：1,293.8346 OKB(借了500 OKB)；永续合约：0.3191	BTC  2,807.64 USDT；期权合约：0.0117					 BTC；比特币单价9300 USDT，总估值 10,049.73 USDT  




## 交易所资金记录

|   时间    |  总净资产   |             币价             |  总额  |
| :-------: | :---------: | :--------------------------: | :----: |
| 2020-4-14 |  4397 USDT  |             7.20             | 31,658 |
| 2020-4-15 |  6376 USDT  |             7.20             | 45907  |
| 2020-4-16 | 7180.5 USDT | 7.13(因USDT增发开始一路暴跌) | 51196  |
| 2020-4-22 |  7283 USDT  |             7.16             | 52146  |
| 2020-4-23 |  7383 USDT  |             7.14             | 52714  |
| 2020-4-30 |  7474 USDT  |             7.09             | 52990  |
| 2020-5-1  |  9475 USDT  |             7.09             | 67177  |





## 总资金进出记录


|   时间    | 操作  |  币种  | 单价  |  数量   |   金钱   | 交易所总资产 | 单次盈亏 |
| :-------: | :---: | :----: | :---: | :-----: | :------: | :----------: | :------: |
| 2020-3-15 |  买   | 比特币 | 4万元 |  0.246  |  一万元  |    10,000    |          |
| 2020-3-20 |  卖   | 比特币 | 4.4万 |  0.246  | 一万九百 |      0       |   +900   |
| 2020-3-28 |  买   | 比特币 | 4.5万 |  0.21   |  一万元  |    10,000    |          |
| 2020-3-31 |  买   |  USDT  | 7.25  |  1379   |  一万元  |    20,000    |          |
| 2020-4-3  |  买   |  USDT  | 7.19  |  695.4  |   五千   |    25,000    |          |
| 2020-4-14 |  买   |  USDT  | 7.21  |   800   |   5768   |    30,768    |          |
| 2020-4-15 |  买   |  USDT  | 7.19  | 1979.41 |  14232   |    45,000    |          |
| 2020-4-16 |  买   |  USDT  | 7.14  | 700.28  |   5000   |    50,000    |          |
| 2020-5-1  |  买   |  USDT  | 7.11  |  1406   |  10000   |    60,000    |          |








